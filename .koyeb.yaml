# Koyeb Configuration File
# This ensures Koyeb builds from the correct directory
# Commit this file to your repository

services:
  - name: sap-backend
    type: web
    instance_type: free
    regions:
      - fra  # Frankfurt (current deployment)
    ports:
      - port: 9000
        protocol: http
    routes:
      - path: /
        port: 9000
    git:
      branch: main
      workdir: server  # CRITICAL: Build from server directory
      buildCommand: npm install
      runCommand: npm start
    env:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: "9000"
      # Add other environment variables via Koyeb dashboard for security
      # Don't commit secrets to GitHub!
    scalings:
      min: 1
      max: 1
    health_checks:
      - http:
          path: /api/health
          port: 9000
          grace_period: 30
